var Y=b=>{throw TypeError(b)};var U=(b,E)=>()=>(E||b((E={exports:{}}).exports,E),E.exports);var K=(b,E,P)=>E.has(b)||Y("Cannot "+P);var _=(b,E,P)=>(K(b,E,"read from private field"),P?P.call(b):E.get(b)),A=(b,E,P)=>E.has(b)?Y("Cannot add the same private member more than once"):E instanceof WeakSet?E.add(b):E.set(b,P),N=(b,E,P,D)=>(K(b,E,"write to private field"),D?D.call(b,P):E.set(b,P),P),q=(b,E,P)=>(K(b,E,"access private method"),P);var W=(b,E,P,D)=>({set _($){N(b,E,$,P)},get _(){return _(b,E,D)}});var X=U((exports,module)=>{// @license      GPLv3
(async function(){var b,E,P,D,$,T,C,L,R,F,B,I,j,V;const{savelib}=loadlib("libloader","allfuncs.js"),proxy_set=new WeakSet,oldproxy=Proxy;window.Proxy=new Proxy(oldproxy,{construct(e,t){const n=new oldproxy(...t);return proxy_set.add(n),n}}),Object.keys(console).forEach(e=>{window[e]=function(...t){var n=[];let o=0;return t.forEach(r=>{let u=`{${o}}${a().randstr().val}`;for(;;){if(isa(r)){n.push("function_chain >"),r=r.val;continue}else if(a(r).gettype("promise").val){o++,r.then((...f)=>window[e]("RESOLVED - "+u,...f)).catch((...f)=>window[e]("REJECTED - "+u,...f)),r="PROMISE - "+u;continue}n.push(r);break}}),console[e](...n),n}});const warn=console.warn.bind(window),log=console.log.bind(window),error=console.error.bind(window);console.time.bind(window),console.timeEnd.bind(window);var getvm=function(){const e=Function.prototype.bind;Function.prototype.bind=function(...t){var n,o;return t[0]&&((o=(n=t[0])==null?void 0:n.hasOwnProperty)!=null&&o.call(n,"editingTarget"))&&t[0].hasOwnProperty("runtime")&&(Function.prototype.bind=e,savelib("scratch",{vm:t[0]})),e.apply(this,t)}};getvm();function isa(e){var t;return((t=e==null?void 0:e[Math.random()])==null?void 0:t.name)==="function_chain"||(e==null?void 0:e.name)==="function_chain"}function noa(e){return isa(e)?e.val:e}const blank={},isstrict={},ischaining={};function a(e,t,n){return t!==ischaining&&(n=[]),e=noa(e),new Proxy({},{set(o,r,u){},get(o,r){var w;if(r==Symbol.toStringTag)return warn(Symbol.toStringTag),"testing";if(r==Symbol.iterator)switch(a(e).gettype().val){case"string":return function*(){for(var i in e.split(""))yield e[i]};case"number":return function*(){for(var i in String(e).split(""))yield e[i]};case"array":return function*(){for(var i in e)yield e[i]};case"object":return function*(){for(var i in Object.entries(e))yield e[i]};default:return function*(){yield e}}if(r==Symbol.toPrimitive)return function(i){switch(i){case"number":return Number(e)!=e&&error(`"${e}" is not a number or is nan`,e),Number(e);case"string":return a(e).gettype(["array","object"]).val?JSON.stringify(e):String(e);case"default":if(a(e).gettype("string").val)return String(Number(e))==e?Number(e):String(e);if(a(e).gettype(["array","object"]).val)return JSON.stringify(e);if(a(e).gettype(["undefined","null","nan"]))return String(e)}return error(r,i),i};if(typeof r=="symbol"&&log(r),["end","out","ret","done","value","val"].includes(r)){if(n.length){var u=[...n];return n=[],u}return e}if(r=="allfuncs")return new Proxy(allfuncs,{set(i,l){throw new Error(`you can't overwrite property "${l}" on "allfuncs".
if you are trying to add a new function
use allfuncs.new(function_name, function, tags)`)},deleteProperty(i,l){throw new Error(`you can't delete property "${l}" on "allfuncs".`)}});if(r=="push")return new Proxy({},{get(i,l){return n.push(e[l]),a(e,ischaining,n)}});if(r=="get")return new Proxy({},{get(i,l){return a(e[l],ischaining,n)}});if(r=="set")return new Proxy({},{get(i,l){return function(s){return e[l]=s,a(e,ischaining,n)}}});if(r=="run")return new Proxy({},{get(i,l){return l=="same"?new Proxy({},{get(s,c){return function(...v){var p=e;return e[c](...v),a(p,ischaining,n)}}}):function(...s){return a(e[l](...s),ischaining,n)}}});const{gettype:f}=allfuncs,d=function(...i){var c,v;if(f(allfuncs[r])!=="function"&&!f(e,["undefined","null","nan"])){if(f(Object.getPrototypeOf(e)[r],"function"))return a(Object.getPrototypeOf(e)[r].call(e,...i));throw new Error(`"${r}" is not a function`)}var l=e===blank?i:[e,...i],s=allfuncs[r](...l);if(f(s,"array")&&((c=e==null?void 0:e.strictargs)==null?void 0:c[0])===isstrict&&((v=s==null?void 0:s.strictargs)==null?void 0:v[0])!==isstrict)switch(e.strictargs[1]){case"object":s=strictobj(e.strictargs[2],e.strictargs[3],s,e.strictargs[5]);break;case"array":s=strictarr(e.strictargs[2],e.strictargs[3],s,e.strictargs[5]);break}return a(s)};var h={};return Object.assign(h,((w=allfuncs[r])==null?void 0:w.function)??{}),Object.assign(h,allfuncs[r]),Object.keys(h).forEach(i=>{let l=h[i];d[i]=function(...s){return a(l(...s))}}),f(allfuncs[r],"function")&&(d.inputs=getprops(allfuncs[r])),d.same=function(...i){var l=e;return a(e,ischaining,n)[r](...i),a(l,ischaining,n)},d.run=function(i){var l=[...d.inputs];l=l.vars.map((v,p)=>p==0?v.var in i?i[v.var]:e==blank?void 0:e:i[v.var]);var s=allfuncs[r](...l);if((e==null?void 0:e.strictargs[0])===isstrict)switch(e.strictargs[1]){case"object":s=strictobj(e.strictargs[2],e.strictargs[3],s,e.strictargs[5]);break;case"array":s=strictarr(e.strictargs[2],e.strictargs[3],s,e.strictargs[5]);break}var c=getprops(allfuncs[r]).return;if(c.split("|").find(v=>v=="any"||v==f(s)))return a(s);throw new Error(`the function "${r}" returned a type of "${f(s)}",
which doesn't match type of "${c}"`)},d}})}function expandederror(e){return error(e),Error(e.message)}const strictfunction=function(e,t,n){if(n){if(getprops(e).broken)return warn("the function is missing type data"),e}else if(getprops(e).broken)throw error(getprops(e)),new Error("the function doesn't have the required type data");var o=function(...r){var u=getprops(e).vars;u.filter(h=>!(h.type.includes("?")||h.type.split("|").includes("none")||h.type.split("|").includes("undefined"))).length>r.length&&error(`function [${Object.getPrototypeOf(e).name||t||"unknown"}] - requires ${u.filter(h=>!h.type.includes("?")).length} arguments but only found ${r.length}`),u.length=r.length,u.map(function(h,w){if(h.type){if(w>r.length-1){if(h.type.includes("?")||h.type.includes("none"))return!0;throw expandederror({message:`function [${Object.getPrototypeOf(e).name||t||"unknown"}] - input "${h.var}" is not optional`,function_name:Object.getPrototypeOf(e).name||t||"unknown",function:e,values:r,function_string:String(e)})}if(h.type.split("|").includes("array")&&a(r[w]).gettype("htmlcollection").val&&(r[w]=[...r[w]]),h.type.split("|").find(i=>!!r[w]&&i=="true"||!r[w]&&i=="false"||a(r[w]).gettype(["null","undefined","nan"]).val&&i=="none"||i=="any"||a(r[w]).gettype(i).val))return!0;if(h.type.split("|").includes("elements")&&a(r[w]).toelem().gettype("array").val)return r[w]=a(r[w]).toelem().val,h.type.split("|").includes("element")&&r[w].length===1&&(r[w]=r[w][0]),!0;if(h.type.split("|").includes("element")&&a(r[w]).toelem(!0).gettype("element").val&&(r[w]=a(r[w]).toelem(!0).val),h.type.split("|").includes("element")&&a(r[w]).toelem(!0).gettype("element").val)return r[w]=a(r[w]).toelem(!0).val,!0;throw expandederror({message:`function [${Object.getPrototypeOf(e).name||t||"unknown"}] - in "${h.var}", the input of "${r[w]}" is a type of "${a(r[w]).gettype().val}", which doesn't match required type of "${h.type}"`,function_name:Object.getPrototypeOf(e).name||t||"unknown",function:e,function_string:String(e)})}else return!0});var f=getprops(e).return;if(a(e).gettype("function").val)var d=e(...r);else var d=new e(...r);if(f.split("|").find(h=>!!d&&h=="true"||!d&&h=="false"||["null","undefined","nan"].includes(a(d).gettype().val)&&h=="none"||h=="any"||a(d).gettype(h).val))return d;throw expandederror({message:`the function [${Object.getPrototypeOf(e).name||t||"unknown"}] returned a type of "${a(d).gettype().val}", which doesn't match type of "${f}"`,function_name:Object.getPrototypeOf(e).name||t||"unknown",function:e,function_string:String(e)})};return o.function=e,o},getprops=function(){var e={};return function(t){var n=String(t).match(/\(([^]*)/)[1];if(e[n])return e[n];var o=[],r;n=n.replaceAll(/\\./g,"").replaceAll(new RegExp("`[^]*?(?<!\\\\)`","g"),"").replaceAll(new RegExp("'.*?(?<!\\\\)'","g"),"").replaceAll(new RegExp('".*?(?<!\\\\)"',"g"),"").replaceAll(new RegExp("(\\/\\/).*|\\/\\*[^]*?\\*(?<!\\\\)\\/","g"),function(s,c){return o.push(c?s.replace("//",""):s.replace(/^\/\*/,"").replace(/\*\/$/,"")),`ᄑ${o.length-1}ᄑ`}).replaceAll(new RegExp("\\/.*?(?<!\\\\)\\/","g"));for(var u=n;u.match(new RegExp("(?<![\\]})])[{\\[(]"))&&(n=u,r=u.match(new RegExp("(?<![\\]})].*?)[{\\[(]")),!!r);){for(var f=0,d=0,h=r.index,w=r.index;d++<40&&(/[\[{(]/.test(r[0])?f++:f--,f!=0);)n=n.slice(r.index+1),r=n.match(/[{\[(\])}]/),w+=r.index+1;u=u.slice(0,h)+"<><><>"+u.slice(w+1)}var i=!1,l={return:o[0],vars:[...[...u.match(/[^]*?(?=\))/)[0].matchAll(new RegExp("(?<=(?:,|^)[^=]*)([a-zA-Z_$][\\da-zA-Z_$]*)(?:(?:[^](?![a-zA-Z_$][\\da-zA-Z_$].*,|,.*[a-zA-Z_$][\\da-zA-Z_$]))*?(?:\\s*=\\s*)?[^\\u1111]*\\u1111(\\d+)\\u1111)?","g"))].map((s,c)=>(s[2]==0&&(i=!0),{var:s[1],type:o[s[2]]}))]};return i&&(l.return=void 0),l.broken=!1,l.return==null&&(l.broken=!0),l.vars.forEach(s=>{s.type===void 0&&(l.broken=!0)}),e[String(t).match(/\(([^]*)/)[1]]=l,l}}(),allfuncs={new(e,t,n){this[e]&&(e+=Math.random(),error(e)),this[e]=e=="gettype"||e=="toelem"?t:strictfunction(t,e,!0);var o=getprops(t);return o=[...o.vars,{return:o.return}],o.map(r=>r.type||(r==null?void 0:r.return)).filter(r=>typeof r!="string").length&&warn(e),this[e].help=o,this[e].function=t,this[e].table=function(){var r=getprops((this==null?void 0:this.function)||allfuncs[e].function),u={};r.vars.forEach(f=>{u={...u,[f.var]:f.type}}),table({...u,broken:r.broken,return:r.return})},n||(n="unknown"),n.includes("/")?n=n.split("/"):typeof n=="string"&&(n=[n]),n.forEach(r=>{this.folders||(this.folders={}),this.folders[r]||(this.folders[r]={}),this.folders[r][e]=t,this.folders[r][e].help=o}),this[e].folders=n,Object.defineProperty(a,"length",{value:Object.keys(allfuncs).length-2}),this[e]}};class tween{constructor(t,n,o,r,u,f,d){A(this,I);A(this,b);A(this,E);A(this,P);A(this,D);A(this,$);A(this,T);A(this,C,[]);A(this,L,[]);A(this,R,0);A(this,F);A(this,B);typeof t=="number"?(N(this,b,t),N(this,E,n),N(this,P,o),N(this,D,r),N(this,$,u),N(this,T,f)):typeof t=="object"&&a(t).foreach(function(w,i){this["#"+w]=i}),this.restart=this.restart,this.onchange=this.onchange,this.ondone=this.ondone,N(this,F,_(this,b)),N(this,B,_(this,E));const h=this;d||(a(window).listen("blur",function(){h.paused||(h.paused=1)}),a(window).listen("focus",function(){h.paused===1&&(h.paused=!1)})),_(this,$)&&N(this,T,!1),N(this,C,[]),N(this,L,[]),q(this,I,j).call(this)}restart(){N(this,b,_(this,F)),N(this,E,_(this,B)),q(this,I,j).call(this)}onchange(t){_(this,C).push(t)}ondone(t){_(this,L).push(t)}destroy(){N(this,R,null),this.paused=!1,N(this,C,void 0),N(this,L,void 0);var t=this;a(this).foreach(function(n){delete t[n]})}}b=new WeakMap,E=new WeakMap,P=new WeakMap,D=new WeakMap,$=new WeakMap,T=new WeakMap,C=new WeakMap,L=new WeakMap,R=new WeakMap,F=new WeakMap,B=new WeakMap,I=new WeakSet,j=async function(){W(this,R)._++;var t=_(this,R),n=_(this,b),o=_(this,E),r=_(this,P),u=_(this,D)||30;this.out=_(this,b);for(var f=0,d=Date.now(),h=0;f<r;){if(t!==_(this,R))return;await a(()=>!this.paused).waituntil().val,a(()=>_(this,C).forEach(l=>l(this.out))).ignore(),d=Date.now();var w=u-h,h=await a(w).wait().val;if(h=Date.now()-d,f+=h,h-=w,t!==_(this,R))return;this.out=a(f).rerange(0,r,n,o).val}t===_(this,R)&&(this.out=o,a(()=>_(this,C).forEach(i=>i(this.out))).ignore(),a(()=>_(this,L).forEach(i=>i())).ignore(),t===_(this,R)&&(_(this,T)&&(q(this,I,V).call(this),q(this,I,j).call(this)),_(this,$)&&q(this,I,j).call(this)))},V=function(){var t=_(this,b);N(this,b,_(this,E)),N(this,E,t)},allfuncs.new("tween",tween,"time",!1),allfuncs.new("foreach",function(e,t){var n=a(e).gettype().val;n=="array"?e.forEach(t):n=="object"?Reflect.ownKeys(e).forEach((o,r)=>{t(o,e[o],r)}):[e].forEach(t)},"array",!0),allfuncs.new("sendevent",function(e,t){function n(i,l){for(var s in l)i[s]=l[s];return i}var o={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},r={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0},u=n(r,arguments[2]||{}),f,d=null;for(var h in o)if(o[h].test(t)){d=h;break}if(!d)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");if(document.createEvent)f=document.createEvent(d),d=="HTMLEvents"?f.initEvent(t,u.bubbles,u.cancelable):f.initMouseEvent(t,u.bubbles,u.cancelable,document.defaultView,u.button,u.pointerX,u.pointerY,u.pointerX,u.pointerY,u.ctrlKey,u.altKey,u.shiftKey,u.metaKey,u.button,e),e.dispatchEvent(f);else{u.clientX=u.pointerX,u.clientY=u.pointerY;var w=document.createEventObject();f=n(w,u),e.fireEvent("on"+t,f)}return e},"element/event/automation"),allfuncs.new("ignore",function(e,t,...n){try{return e(...n)}catch(o){return t?o.message:void 0}},"error",!0),allfuncs.new("wait",function(e){return new Promise(function(t){var n=Date.now();setTimeout(()=>t(Date.now()-n-e),e)})},"time",!0),allfuncs.new("waituntil",function(e,t){return new Promise(n=>{var o=Date.now(),r=setInterval(function(u,f){u()&&(clearInterval(r),a(()=>f(Date.now()-o)).ignore(),n(Date.now()-o))},0,e,t)})},"time",!0),allfuncs.new("keeponlyone",function(e){return[...new Set(e)]},"array",!0),allfuncs.new("inin",function(e,t,n){return n[t.indexOf(e)]},"array",!0),allfuncs.new("matchall",function(e,t){return[...e.matchAll(t)].map(n=>n[1]!==void 0?[...n]:n[0])},"regex",!0),allfuncs.new("matchany",function(e,...t){return t.includes(e)},"string",!0),allfuncs.new("randfrom",function(e,t){return t===void 0?e.length?e[a(0).randfrom(e.length-1).val]:"":e==t?e:t?Math.round(Math.random()*(t-e))+e:e[Math.round(Math.random()*(e.length-1))]},"number/array",!0),allfuncs.new("unlisten",function(e){return e.forEach(t=>t[0].removeEventListener(t[1],t[2])),e},"event/elem",!0),allfuncs.new("listen",function(e,t,n,o=!1){var r=[];if(a(t).gettype("array").val){var u={};a(t).foreach(f=>u[f]=n),t=u}return a(t).gettype("object").val?(o=n,a(t).foreach(function(f,d){a(f).gettype("string").val&&(f=a(f).matchall(/[a-z]+/g).val),f.forEach(h=>{const w=function(...i){d(...i)};e.addEventListener(h,w,o),r.push([e,h,w])})})):a(t).gettype("string").val&&(t=a(t).matchall(/[a-z]+/g).val,t.forEach(f=>{const d=function(h){n(h,f)};e.addEventListener(f,d,o),r.push([e,f,d])})),r},"event/elem",!0),allfuncs.new("toelem",function(e,t){if(a(e).gettype("element").val)return e;switch(a(e).gettype().val){case"string":return t?a(e).qs().val:a(e).qsa().val;case"array":return e.map(o=>a(o).toelem(t).val);case"object":var n={...e};return t?{[Object.keys(n)[0]]:a(n[Object.keys(n)[0]]).toelem(t).val}:(a(n).foreach(function(o,r){n[o]=o(r).toelem().val}),n);default:error(e,"inside [toelem] - not an element?");return}},"elem",!0),allfuncs.new("geturlperams",function(e=location.href){var t={};return[...e.matchAll(/[?&]([^&\s]+?)(?:=([^&\s]*?))?(?=&|$|\s)/g)].forEach(n=>{n[1].includes("#")&&(t["#"]=n[1].match(/#(.*$)/)[1]),n[2].includes("#")&&(t["#"]=n[2].match(/#(.*$)/)[1]),n[1]=n[1].replace(/#.*$/,""),n[2]=n[2].replace(/#.*$/,""),t[decodeURIComponent(n[1]).replaceAll("+"," ")]=n[2]===void 0?void 0:decodeURIComponent(n[2]).replaceAll("+"," ")}),t},"url",!1),allfuncs.new("updateurlperam",function(e,t,n){var o={...a().geturlperams().val,[e]:t},r="",u="";return a(o).foreach(function(f,d){if(f=="#")return u=f+d;f=encodeURIComponent(f),d=encodeURIComponent(d),r+="&"+(d===void 0?f:f+"="+d)}),r=r.replace("&","?"),r+=u,n?history.pushState(null,null,r):history.replaceState(null,null,r),e},"url",!0),allfuncs.new("newvarfunc",function(e,t,n=window){Object.defineProperty(n,e,{configurable:!1,get(){return t.call({})},set(o){return t.call(o,o,!0)}})},"var",!0),allfuncs.new("rerange",function(e,t,n,o,r){return(e-t)/(n-t)*(r-o)+o},"number",!1),allfuncs.new("destring",function(e){var t=e;if(/^[\-0-9]+$/.test(e))return Number(e);if(a(t=JSON.parse(e)).gettype("array").val||a(t=JSON.parse(e.replaceAll("'",'"').replaceAll("`",'"'))).gettype("object").val)return t;if(e=="true")return!0;if(e=="false")return!1;if(e!="undefined")return e=="NaN"?NaN:e},"string/parse",!0),allfuncs.new("eachelem",function(e,t){var n=[],o=[];return a(e).gettype("array").val?e.foreach(r=>{o=[...o,...a(r).gettype("string").val?a(r).qsa().val:[r]]}):o=a(e).gettype("string").val?a(ar1).qsa().val:[e],o=o.filter(r=>r instanceof Element),o.foreach(function(...r){n.push(t(...r))}),n.length==1&&(n=n[0]),n},"elem",!0),allfuncs.new("remove",function(e,t,n){return e=[...e],t=n?t:e.indexOf(t),t<0||typeof t!="number"||e.splice(t,1),e},"array",!0),allfuncs.new("download",function(e,t="temp.txt",n,o){var r;if(o)r=e;else{var u=a(e).gettype("string").val?new Blob([e],{type:n}):(e.name&&(t=e.name),e);r=URL.createObjectURL(u)}return a().bodyload().then(()=>{var f=a(document.body).createelem("a",{href:r,download:t}).val;f.click(),f.remove(),o||window.URL.revokeObjectURL(r)}),e},"file",!0),allfuncs.new("idx",function(e,t){return t>=0?e[t]:e[e.length+t]},"array",!0),allfuncs.new("compare",function(e,t){return e&&t?(typeof e=="string"?e.toLowerCase():e)==(typeof t=="string"?t.toLowerCase():t):!0},"check",!0),allfuncs.new("createelem",function(e,t,n={}){var u,f;var o=t,r=t=="svg"||((f=(u=e==null?void 0:e.tagName)==null?void 0:u.toLowerCase)==null?void 0:f.call(u))=="svg";return t=r?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t),n.class&&n.class.split(" ").forEach(d=>{t.classList.add(d)}),n.options&&o=="select"&&(n.options=n.options.map(d=>a(d).gettype("array").val?a(t).createelem("option",{innerHTML:d[0],value:d[1]}).val:a(t).createelem("option",{innerHTML:d,value:d}).val)),o=="label"&&"for"in n&&(n.htmlFor=n.for),Object.assign(t.style,n),o=="select"?a(n).foreach(function(d,h){t[d]=h}):r?Object.keys(n).forEach(d=>t[d]=n[d]):Object.assign(t,n),typeof e=="string"&&(e=a(e).qs().val),a(()=>e.appendChild(t)).ignore(),t},"elem",!0),allfuncs.new("gettype",function(e,t){if(!t||Object.prototype.toString.call(t).toLowerCase().match(/^\[[a-z]+ (.+)\]$/)[1]=="string"&&!t.includes("|")){var n=Object.prototype.toString.call(e).toLowerCase().match(/^\[[a-z]+ (.+)\]$/)[1];if(n!=="function"&&n==t)return!0;if(t=="normalfunction")return n=="function";if(n=="htmldocument"&&t=="document"||t=="body"&&n=="htmlbodyelement"||t&&new RegExp(`^html${t}element$`).test(n)||(/^html\w+element$/.test(n)&&(n="element"),n=="htmldocument"&&(n="element"),n=="asyncfunction"&&(n="function"),n=="generatorfunction"&&(n="function"),n=="regexp"&&(n="regex"),t=="regexp"&&(t="regex"),t=="element"&&n=="window")||t=="element"&&n=="shadowroot"||t=="event"&&/\w+event$/.test(n))return!0;if(/^(html|svg).*element$/.test(n)&&(n="element"),n=="function"&&(n=/^\s*class\s/.test(Function.prototype.toString.call(e))?"class":"function"),t=="none")return n=="nan"||n=="undefined"||n=="null";try{if(n==="number"&&isNaN(e)&&t=="nan")return!0}catch{error(e)}return t?t===n:n}else return t.includes("|")&&(t=t.split("|")),t=[...new Set(t)],t.filter(o=>a(e).gettype(o).val).length>0},"check",!0),allfuncs.new("waitforelem",async function(e){return a(e).gettype("string").val&&(e=[e]),await a().bodyload(),new Promise(t=>{var n=new MutationObserver(o);n.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!1}),o();function o(){e.find(r=>!a(r).qs().val)||(n.disconnect(),t(e.length==1?a(e[0]).qs().val:e.map(r=>a(r).qs().val)))}})},"time/elem"),allfuncs.new("findvar",function(e,t,n="obj",o,r){for(var u=[],f=[],d=n,h=[],w=[{chain:d,value:e}],i=[],l=0;w.length&&l++<800;){if(w.map(c=>c.chain).join("/").includes("."+t+(o?"/":"")))if(r)u.push(w.filter(c=>o?c.chain.endsWith("."+t):c.chain.includes("."+t)));else return w.filter(c=>o?c.chain.endsWith("."+t):c.chain.includes("."+t))[0];var s=[...w];f.push(w),w=[],s.forEach(c=>{(a(c.value).gettype("object").val||a(c.value).gettype("element").val)&&a(c.value).foreach(function(v,p){if(a(v).gettype().val!=="string")return warn(v,a(v).gettype().val);var g=/^[a-z_][_a-z0-9]*$/i.test(v)?"."+v:`["${v.replaceAll('"','\\"')}"]`;h.push(c.chain+g),!i.includes(c.value)&&w.push({chain:c.chain+g,value:p})}),i.push(c.value)})}return u.length>0?u:f},"debug",!1),allfuncs.new("getallvars",function(){var e={},t=[];for(var n in this)"window self document name location customElements history locationbar menubar personalbar scrollbars statusbar toolbar status closed frames length top opener parent frameElement navigator origin external screen innerWidth innerHeight scrollX pageXOffset scrollY pageYOffset visualViewport screenX screenY outerWidth outerHeight devicePixelRatio clientInformation screenLeft screenTop styleMedia onsearch isSecureContext trustedTypes performance onappinstalled onbeforeinstallprompt crypto indexedDB sessionStorage localStorage onbeforexrselect onabort onbeforeinput onblur oncancel oncanplay oncanplaythrough onchange onclick onclose oncontextlost oncontextmenu oncontextrestored oncuechange ondblclick ondrag ondragend ondragenter ondragleave ondragover ondragstart ondrop ondurationchange onemptied onended onerror onfocus onformdata oninput oninvalid onkeydown onkeypress onkeyup onload onloadeddata onloadedmetadata onloadstart onmousedown onmouseenter onmouseleave onmousemove onmouseout onmouseover onmouseup onmousewheel onpause onplay onplaying onprogress onratechange onreset onresize onscroll onsecuritypolicyviolation onseeked onseeking onselect onslotchange onstalled onsubmit onsuspend ontimeupdate ontoggle onvolumechange onwaiting onwebkitanimationend onwebkitanimationiteration onwebkitanimationstart onwebkittransitionend onwheel onauxclick ongotpointercapture onlostpointercapture onpointerdown onpointermove onpointerrawupdate onpointerup onpointercancel onpointerover onpointerout onpointerenter onpointerleave onselectstart onselectionchange onanimationend onanimationiteration onanimationstart ontransitionrun ontransitionstart ontransitionend ontransitioncancel onafterprint onbeforeprint onbeforeunload onhashchange onlanguagechange onmessage onmessageerror onoffline ononline onpagehide onpageshow onpopstate onrejectionhandled onstorage onunhandledrejection onunload crossOriginIsolated scheduler alert atob blur btoa cancelAnimationFrame cancelIdleCallback captureEvents clearInterval clearTimeout close confirm createImageBitmap fetch find focus getComputedStyle getSelection matchMedia moveBy moveTo open postMessage print prompt queueMicrotask releaseEvents reportError requestAnimationFrame requestIdleCallback resizeBy resizeTo scroll scrollBy scrollTo setInterval setTimeout stop structuredClone webkitCancelAnimationFrame webkitRequestAnimationFrame originAgentCluster navigation webkitStorageInfo speechSynthesis oncontentvisibilityautostatechange openDatabase webkitRequestFileSystem webkitResolveLocalFileSystemURL chrome caches cookieStore ondevicemotion ondeviceorientation ondeviceorientationabsolute launchQueue onbeforematch getDigitalGoodsService getScreenDetails queryLocalFonts showDirectoryPicker showOpenFilePicker showSaveFilePicker TEMPORARY PERSISTENT addEventListener dispatchEvent removeEventListener".split(" ").includes(n)||t.push(n);return t.forEach(o=>{var r=String(a(this[o]).gettype().val);r==="object"&&(r="variable"),e[r]||(e[r]=[]),e[r].push(o)}),e},"debug",!1),allfuncs.new("newfunc",function(func1,func2){eval(`var a = ${func1}
    var s = ${func2}
    ${func1} = function (...args) {
    a.call(this, ...args)
    s(arguments)
    }`)},"function/jank",!0),allfuncs.new("findall",function(e,t="obj"){for(var n=t,o=[],r=[{chain:n,value:e}],u=[],f=0;r.length&&f++<800;){var d=[...r];r=[],d.forEach(h=>{a(h.value).gettype("object").val&&a(h.value).foreach(function(w,i){var l=/^[_a-z][_a-z0-9]*$/i.test(w)?"."+w:`["${w.replaceAll('"','\\"')}"]`;o.push(h.chain+l),!u.includes(h.value)&&(log({key:w,value:i,chain:h.chain+l}),r.push({chain:h.chain+l,value:i}))}),u.push(h.value)})}return u},"debug",!0),allfuncs.new("sha",function(e="",t){var n;return typeof t=="string"?n=t:t?n="`~\\|[];',./{}:<>?\"!@#$%^&*ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789":n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",w(o(h(e),e.length*8));function o(i,l){i[l>>5]|=128<<24-l,i[(l+64>>9<<4)+15]=l;for(var s=Array(80),c=1732584193,v=-271733879,p=-1732584194,g=271733878,m=-1009589776,x=0;x<i.length;x+=16){for(var y=c,S=v,k=p,M=g,H=m,O=0;O<80;O++){O<16?s[O]=i[x+O]:s[O]=d(s[O-3]^s[O-8]^s[O-14]^s[O-16],1);var z=f(f(d(c,5),r(O,v,p,g)),f(f(m,s[O]),u(O)));m=g,g=p,p=d(v,30),v=c,c=z}c=f(c,y),v=f(v,S),p=f(p,k),g=f(g,M),m=f(m,H)}return Array(c,v,p,g,m)}function r(i,l,s,c){return i<20?l&s|~l&c:i<40?l^s^c:i<60?l&s|l&c|s&c:l^s^c}function u(i){return i<20?1518500249:i<40?1859775393:i<60?-1894007588:-899497514}function f(i,l){var s=(i&65535)+(l&65535),c=(i>>16)+(l>>16)+(s>>16);return c<<16|s&65535}function d(i,l){return i<<l|i>>>32-l}function h(i){for(var l=Array(),s=255,c=0;c<i.length*8;c+=8)l[c>>5]|=(i.charCodeAt(c/8)&s)<<24-c;return l}function w(i){for(var l="",s=0;s<i.length*4;s+=3)for(var c=(i[s>>2]>>8*(3-s%4)&255)<<16|(i[s+1>>2]>>8*(3-(s+1)%4)&255)<<8|i[s+2>>2]>>8*(3-(s+2)%4)&255,v=0;v<4;v++)s*8+v*6>i.length*32?l+="":l+=n.charAt(c>>6*(3-v)&63);return l}},"code",!0),allfuncs.new("qs",function(e,t=document){return t.querySelector(e)},"elem",!0),allfuncs.new("qsa",function(e,t=document){return Array.from(t.querySelectorAll(e))},"elem",!0),allfuncs.new("csspath",function(e){if(a(e).gettype("array").val)return a(e).map(u=>a(u).csspath().val);if(e instanceof Element){for(var t=[];e.nodeType===Node.ELEMENT_NODE;){var n=e.nodeName.toLowerCase();if(e.id){n+="#"+e.id,t.unshift(n);break}else{for(var o=e,r=1;o=o.previousElementSibling;)o.nodeName.toLowerCase()==n&&r++;r!=1&&(n+=":nth-of-type("+r+")")}t.unshift(n),e=e.parentNode}return t.join(" > ")}},"elem",!0),allfuncs.new("fromms",function(e){return e=Number(e),{years:Math.floor(e/1e3/60/60/24/365),days:Math.floor(e/1e3/60/60/24)%365,hours:Math.floor(e/1e3/60/60)%24,mins:Math.floor(e/1e3/60)%60,secs:Math.floor(e/1e3)%60,ms:Math.floor(e)%1e3}},"time",!0),allfuncs.new("toms",function({ms:e=0,secs:t=0,mins:n=0,hours:o=0,days:r=0,years:u=0}){return e+t*1e3+n*6e4+o*36e5+r*864e5+u*3156e7},"time",!0),allfuncs.new("rect",function(e){a(e).gettype("string").val&&(e=a(e).qs().val);var{x:t,y:n,width:o,height:r}=e.getBoundingClientRect().toJSON();return{x:t,y:n,w:o,h:r}},"elem",!0),allfuncs.new("setelem",function(e,t){var o,r;var n=e=="svg"||((r=(o=parent==null?void 0:parent.tagName)==null?void 0:o.toLowerCase)==null?void 0:r.call(o))=="svg";return t.class&&t.class.split(" ").forEach(u=>{e.classList.add(u)}),t.options&&e.tagName.toLowerCase()=="select"&&(t.options=t.options.map(u=>a(u).gettype("array").val?a(e).createelem("option",{innerHTML:u[0],value:u[1]}).val:a(e).createelem("option",{innerHTML:u,value:u}).val)),e.tagName.toLowerCase()=="label"&&"for"in t&&(t.htmlFor=t.for),Object.assign(e.style,t),e.tagName.toLowerCase()=="select"?a(t).foreach(function(u,f){e[u]=f}):n?Object.keys(t).forEach(u=>e[u]=t[u]):Object.assign(e,t),e},"elem",!0),allfuncs.new("watchvar",function(e,t,n,o=window){o=o||window,o[`_${e}`]=void 0,o[`${e}`]=void 0,Object.defineProperty(o,e,{configurable:!1,get(){return n?n(o[`_${e}`]):o[`_${e}`]},set(r){if(r!==o[`_${r}`]){var u=t(r,o[`_${e}`]);u&&(o[`_${e}`]=r)}}})},"var/debug",!0),allfuncs.new("randomizeorder",function(e){e=[...e];for(var t=[],n=e.length,o=0;o<n;o++){var r=randfrom(0,e.length-1);t.push(e[r]),e.splice(r,1)}return t},"array",!0),allfuncs.new("constrainvar",function(e,t,n){window[`_${e}`]=void 0,window[`${e}`]=void 0,Object.defineProperty(window,e,{configurable:!1,get(){return window[`_${e}`]},set(o){o!==window[`_${e}`]&&(o>n&&(o=n),o<t&&(o=t),window[`_${e}`]=o)}})},"var",!0),allfuncs.new("isbetween",function(e,t,n){if(t==n)return!1;var o,r;if(t>n)o=t,r=n;else return o=n,r=t,e>o&&e<r},"check",!0),allfuncs.new("indexsof",function(e,t){var n=0,o=[];return e.split(t).forEach((r,u)=>{n+=r.length,o.push(n+u)}),o.pop(),o},"array",!0),allfuncs.new("export",function(){var e=[];return a("input, textarea").qsa().foreach(t=>{e.push({path:a(t).csspath().val,value:escape(t.value),checked:t.checked})}),JSON.stringify(e)},"data",!1),allfuncs.new("import",function(e){return e.forEach(t=>{var n=a(t.path).qs().val;n.checked=t.checked,n.value=unescape(t.value)}),e},"data",!0),allfuncs.new("popup",function(e,t,n,o,r){if(t||t===0){t=screen.width/100*t,n=screen.height/100*n,o=screen.width/100*o,r=screen.height/100*r;var u=open("","",`left=${t}, top=${n} width=${o},height=${r}`);return u.document.write(e),u}else{var u=open("");return u.document.write(e),u}},"window",!0),allfuncs.new("same",function(...e){return e.length==1&&(e=e[0]),[...new Set(e.map(t=>JSON.stringify(t)))].length===1},"check",!0),allfuncs.new("containsany",function(e,t){return!!t.find(n=>e.includes(n))},"array"),allfuncs.new("run",function(e,t){return e(...getprops(e).vars.map(n=>t[n.var]))},"function",!0),allfuncs.new("getprops",function(e,t){return t?getprops(e).vars.map(n=>n.var).filter(n=>n):getprops(e)},"function/parse",!0),allfuncs.new("bodyload",function(){return new Promise(e=>{document.body&&e();const t=setInterval(()=>{document.body&&e(clearInterval(t))})})},"elem/time",!1),async function(){var u,f;const{bodyload:e}=allfuncs;await e(),localStorage.buttonsheight||(localStorage.buttonsheight="100px"),localStorage.buttonswidth||(localStorage.buttonswidth="120px");var t=document.body;if(!window.optionselem){t=a(t).createelem("div",{position:"fixed",top:(Number(localStorage.buttonsy)||10)+"px",left:(Number(localStorage.buttonsx)||Number(localStorage.buttonswidth.match(/[0-9]+/)[0])/2)+"px",width:0,height:0,zIndex:999999999999999,pointerEvents:"all",backgroundColor:"#0000"}).val.attachShadow({mode:"closed"}),window.optionselem=a(t).createelem("div",{overflow:"hidden",position:"fixed",top:o(0+50/2,innerHeight-this.clientHeight/2)+"px",left:o(localStorage.buttonswidth,0+this.clientWidth/2,innerWidth-this.clientWidth/2)+"px",zIndex:999999999999999,height:"20px",pointerEvents:"all",backgroundColor:"#0f09",test(d){!this.moving&&d||(d||(this.style.translate="0 0",d={clientX:this.getBoundingClientRect().toJSON().x,clientY:this.getBoundingClientRect().toJSON().y}),this.style.top=o(d.clientY-10,0,innerHeight-this.clientHeight)+"px",this.style.left=o(d.clientX-this.clientWidth/2,0,innerWidth-this.clientWidth)+"px",localStorage.buttonsx=d.clientX,localStorage.buttonsy=d.clientY)},onmouseup(){this.moving=!1}}).val,optionselem.style.left=o(Number(localStorage.buttonswidth)||0,0+optionselem.clientWidth/2,innerWidth-optionselem.clientWidth/2)+"px",optionselem.style.top=o(Number(localStorage.buttonsy)||10,0+50/2,innerHeight-optionselem.clientHeight/2)+"px";var n;try{n=((f=(u=window==null?void 0:window.parent)==null?void 0:u.location)==null?void 0:f.href)===location.href}catch{n=!1}a(window.optionselem).createelem("div",{backgroundColor:n?"#00f":"#f00",width:"100%",height:"20px",oncontextmenu(d){d.preventDefault(),log(window.optionselem),window.optionselem.style.height==="20px"?window.optionselem.style.height="auto":window.optionselem.style.height="20px"},onmousedown(d){d.preventDefault(),!(d.which==3||d.button==2)&&(window.optionselem.moving=!0)},onmouseup(){window.optionselem.moving=!1}})}function o(d,h,w){if(w>h){var i=w;w=h,h=i}return Math.min(h,Math.max(w,d))}a(window).listen({resize(){window.optionselem.moving=!1,optionselem.test.call(optionselem)},blur(){window.optionselem.moving=!1},focus(){window.optionselem.moving=!1},mousemove(d){optionselem.test.call(optionselem,d)}});function r(...d){var h=d[0],w=a(optionselem).createelem("div",{textAlign:"center",width:localStorage.buttonswidth,minHeight:localStorage.buttonsheight,backgroundColor:h.backgroundColor||"#0000"}).val;a(w).createelem("p",{innerHTML:h.title||" ",textAlign:"center",color:h.titlecolor}),[...d].forEach((i,l)=>{if(l!==0){var s;switch(i.type){case"button":s=a(w).createelem("button",{id:i.id,itemnumber:l,index:l,innerHTML:i.text,onclick:i.onclick,textAlign:"center"}).val;break;case"toggle":s=a(w).createelem("input",{id:i.id,itemnumber:l,index:l,type:"checkbox",onclick(v){var p,g,m,x,y,S;this.checked?(g=(p=i.onon)==null?void 0:p.call)==null||g.call(p,this,v):(x=(m=i.onoff)==null?void 0:m.call)==null||x.call(m,this,v),(S=(y=i.onclick)==null?void 0:y.call)==null||S.call(y,this,v)}}).val;break;case"select":var c=a(w).createelem("select",{id:i.id,options:i.options,index:l,itemnumber:l,value:i.value,onchange:i.onchange}).val;s=c;break;case"input":s=a(w).createelem("input",{id:i.id,itemnumber:l,index:l,width:"90%",value:i.value,placeholder:i.placeholder,onchange(v){i.onchange.call(this,v)}}).val;break;case"p":s=a(w).createelem("p",{id:i.id,innerHTML:i.text}).val;break;case"br":s=a(w).createelem("br",{}).val;break;default:error(`type not found: "${i.type}"`)}i.id&&(window[i.id]=s)}})}allfuncs.new("addnewoption",r,"elem",!0)}(),allfuncs.new("replacealltext",function(e,t,n=document.body){return[n,...n.querySelectorAll("*:not(script):not(noscript):not(style)")].forEach(({childNodes:[...o]})=>o.filter(({nodeType:r})=>r===Node.TEXT_NODE).forEach(r=>r.textContent=r.textContent.replaceAll(e,t))),e},"string",!0),allfuncs.new("repeat",function(e,t,n,o,r){if(n||r)return new Promise(async f=>{if(n){for(var d=0,h=0;h<t;h++)o&&(r?await e(h):e(h)),d=await a(n-d).wait().val,o||(r?await e(h):e(h));f()}else for(var h=0;h<t;h++)r?await e(h):e(h);f()});for(var u=0;u<t;u++)e(u)},"repeat",!0),allfuncs.new("repeatuntil",function(e,t,n,o,r){return new Promise(async u=>{if(n){for(var f=0,d=0;!t();)d++,o&&(r?await e(d):e(d)),f=await a(n-f).wait().val,o||(r?await e(d):e(d));u()}else{for(var d=0;!t();)d++,r?await e(d):e(d);u()}})},"repeat",!0),(async()=>{const e=[];await a().bodyload(),a(document.body).listen({dragover(t){t.preventDefault()},async drop(t){t.preventDefault(),e.forEach(async({types:n,multi:o,func:r,elem:u})=>{if(!(u&&t.target!==u)){if(o)var f=[];for(const d of t.dataTransfer.items)if(d.kind=="file"&&(n.includes("file")||n.includes("directory"))){const h=await d.getAsFileSystemHandle();if(h.kind==="file"&&n.includes("file")){if(!o)return r(h,t);f.push(h)}else if(h.kind==="directory"&&n.includes("directory")){if(!o)return r(h,t);f.push(h)}}if(o&&f.length)return r(f,t)}})}}),allfuncs.new("ondrop",function(t){if(t.types||(t.types="all"),t.types=a(t.types).toarray().val,!t.func)throw new Error('object is missing "func"');var n=t.elem;if(t.elem&&(t.elem=a(t.elem).toelem(!0).val),t.elem&&!a(t.elem).gettype("element").val)throw new Error(`elem is not an elem, ${n} -> ${t.elem}`);return e.push(t),t},"file")})(),allfuncs.new("getfolderpath",async function(e){async function t(n,o){if(o)var r=[];else return[{name:n.name,inside:await t(n,!0),type:"folder",handle:n}];for await(const[u,f]of n.entries())r.push(a(f).gettype("filesystemdirectoryhandle").val?{type:"folder",inside:await t(f,!0),name:u,handle:f}:{type:"file",handle:f,name:u});return r}return t(e)},"file",!1),allfuncs.new("getfiles",async function(e,t,n=[],o={}){const r="showOpenFilePicker"in window&&(()=>{try{return window.self===window.top}catch{return!1}})();if(!e){if(!r)throw new Error("no access");let u;try{const f=await showOpenFilePicker({types:[{accept:{"*/*":n}}],multiple:t,...o});t?u=await Promise.all(f):u=f[0]}catch(f){f.name!=="AbortError"&&error(f.name,f.message)}return u}return new Promise(async u=>{await a().bodyload().val;const f=document.createElement("input");f.style.display="none",f.type="file",n&&(f.accept=n),document.body.append(f),t&&(f.multiple=!0),f.addEventListener("change",()=>{f.remove(),u(t?Array.from(f.files):f.files[0])}),"showPicker"in HTMLInputElement.prototype?f.showPicker():f.click()})},"file",!0),allfuncs.new("map",function(e,t){var n=a(e).gettype().val;if(n=="array")return e.map(t);if(n=="object"){var o={};return Reflect.ownKeys(e).forEach((r,u)=>{o={...o,...t(r,e[r],u)}}),o}else return[e].map(t)},"array",!0),allfuncs.new("find",function(e,t){var n=a(e).gettype().val;return n=="array"?e.find(t):n=="object"?Reflect.ownKeys(e).find((o,r)=>t(o,e[o],r)):[e].find(t)},"array",!0),allfuncs.new("filteridx",function(e,t){return a(e).gettype("object").val&&(e=[e]),a(e).map((n,o)=>t(n,o)?o:void 0).filter(n=>n!==void 0)},"array"),allfuncs.new("filter",function(e,t){var n=a(e).gettype().val;if(n=="array")return e.filter(t);if(n=="object"){var o={};return Reflect.ownKeys(e).forEach((r,u)=>{t(r,e[r],u)&&(o={...o,[r]:e[r]})}),o}else return[e].filter(t)},"array",!0),function(){var e,t=allfuncs.new("unique",function(){return e||(e=t.new())},"check",!1);t.new=function(n){var o=new Proxy({},{get(r,u){return u=="name"?n||"different":o},set(){return o}});return e=o}}(),allfuncs.new("elif",function(e,t,n){return e?t:n},"check",!0),allfuncs.new("tonumber",function(e){return Number(e)},"number/format",!0),allfuncs.new("toarray",function(e,t){if(a(e).gettype("string").val)if(t)e=e.split(t);else return[e];return[...e]},"number/format",!0),allfuncs.new("tostring",function(e){return["object","array"].includes(a(e).gettype().val)?JSON.stringify(e):a(e).gettype("element").val?a(e).csspath().val:String(e)},"string/format",!0),allfuncs.new("eval",function(a){return eval(a)},"js/eval",!0),allfuncs.new("toregex",function(e,t){if(a(e).gettype("array").val)var o=e;if(t)var o=[e,t];else if(String(e).match(/^\/(.*)\/(\w*)$/))var n=String(e).match(/^\/(.*)\/(\w*)$/),o=[n[1],n[2]];else var o=[String(e),""];return o[1]=o[1].toLowerCase(),o[1].includes("w")&&(o[1]=o[1].replace("w",""),o[0]=`(?<=[^a-z0-9]|^)${o[0]}(?=[^a-z0-9]|$)`),new RegExp(o[0],o[1].replaceAll(/(.)(?=.*\1)/g,""))},"regex",!0),allfuncs.new("isregex",function(e){return a(e).gettype("regex").val?!0:new RegExp("^\\/.*(?<!\\\\)\\/[gimusy]*$").test(e)&&!/^\/\*.*\*\/$/.test(e)},"check",!0),allfuncs.new("ispressed",function(e,t){t=t.toLowerCase();var n=e.shiftKey==t.includes("shift")&&e.altKey==t.includes("alt")&&e.ctrlKey==t.includes("ctrl")&&e.metaKey==t.includes("meta")&&e.key.toLowerCase()==t.replaceAll(/alt|ctrl|shift|meta/g,"").trim();return n&&!a&&e.preventDefault(),n},"check/input/event",!0),allfuncs.new("controller_vibrate",function(e,t=1e3,n=0,o=0){return getpad(e).vibrationActuator.playEffect("dual-rumble",{duration:t,strongMagnitude:n,weakMagnitude:o}),e},"controller/haptic",!0),allfuncs.new("controller_getbutton",function(e,t){return t?getpad(e).buttons[t].value:getpad(e).buttons.map(n=>n.value)},"controller/input",!0),allfuncs.new("controller_getaxes",function(e,t){return t?getpad(e).axes[t]:getpad(e).axes},"controller/input",!0),allfuncs.new("controller_exists",function(e){return e===void 0?getpad().filter(t=>t).length:!!getpad(e)},"controller/check",!0),allfuncs.new("runall",function(e,t){return a(t).gettype("array").val||(t=[t]),a(e).gettype("array").val||(e=[e]),e.map(n=>n(...t)),e},"function"),allfuncs.new("readfile",async function(e,t="Text"){return new Promise(function(n,o){var r=new FileReader;r.onerror=o,r.onload=()=>n(t=="json"?JSON.parse(r.result):r.result),r["readAs"+(t=="json"?"Text":t)](e)})},"file"),allfuncs.new("writefile",async function e(t,n){var o=await await t.createWritable();return await o.write(n),await o.close(),t},"file"),allfuncs.new("getfileperms",async function(e,t){const n={};return t&&(n.mode="readwrite"),await e.queryPermission(n)==="granted"||await e.requestPermission(n)==="granted"},"file/permission",!0),allfuncs.new("indexeddb_set",async function(e,t){return new Promise((n,o)=>e.put(t,r=>n(r),r=>o(r)))},"indexeddb",!0),allfuncs.new("indexeddb_get",async function(e,t){return new Promise((n,o)=>e.get(t,r=>n(r),r=>o(r)))},"indexeddb",!0),allfuncs.new("indexeddb_getall",async function(e){return new Promise((t,n)=>e.getAll(o=>t(o),o=>n(o)))},"indexeddb",!0),allfuncs.new("indexeddb_clearall",async function(e){return new Promise((t,n)=>e.clear(o=>t(o),o=>n(o)))},"indexeddb",!0),allfuncs.new("indexeddb_remove",async function(e,t){return new Promise((n,o)=>e.remove(t,r=>n(r),r=>o(r)))},"indexeddb",!0),allfuncs.new("indexeddb_setup",async function(e){return new Promise(t=>{var n;e={dbVersion:1,storeName:"tempstorename",keyPath:"id",autoIncrement:!0,...e,onStoreReady(){t(n)}},window.IDBStore||function(o,r,u){typeof define=="function"?define(r):typeof module<"u"&&module.exports?module.exports=r():u[o]=r()}("IDBStore",function(){function o(i,l){var s,c;for(s in l)c=l[s],c!==w[s]&&c!==i[s]&&(i[s]=c);return i}var r=function(i){throw i},u=function(){},f={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:r,indexes:[],implementationPreference:["indexedDB","webkitIndexedDB","mozIndexedDB","shimIndexedDB"]},d=function(i,l){typeof l>"u"&&typeof i=="function"&&(l=i),Object.prototype.toString.call(i)!="[object Object]"&&(i={});for(var s in f)this[s]=typeof i[s]<"u"?i[s]:f[s];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,l&&(this.onStoreReady=l);var c=typeof window=="object"?window:self;this.implementation=this.implementationPreference.filter(function(v){return v in c})[0],this.idb=c[this.implementation],this.keyRange=c.IDBKeyRange||c.webkitIDBKeyRange||c.mozIDBKeyRange,this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()},h={constructor:d,version:"1.7.2",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,implementationPreference:null,implementation:"",onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var i=this.idb.open(this.dbName,this.dbVersion),l=!1;i.onerror=(function(s){var c;c="error"in s.target?s.target.error.name=="VersionError":"errorCode"in s.target?s.target.errorCode==12:!1,c?this.onError(Error("The version number provided is lower than the existing one.")):(s.target.error?s=s.target.error:(c="IndexedDB unknown error occurred when opening DB "+this.dbName+" version "+this.dbVersion,"errorCode"in s.target&&(c+=" with error code "+s.target.errorCode),s=Error(c)),this.onError(s))}).bind(this),i.onsuccess=(function(s){if(!l)if(this.db)this.onStoreReady();else if(this.db=s.target.result,typeof this.db.version=="string")this.onError(Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."));else if(this.db.objectStoreNames.contains(this.storeName)){this.store=this.db.transaction([this.storeName],this.consts.READ_ONLY).objectStore(this.storeName);var c=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(v){var p=v.name;if(p)if(this.normalizeIndexData(v),this.hasIndex(p)){var g=this.store.index(p);this.indexComplies(g,v)||(l=!0,this.onError(Error('Cannot modify index "'+p+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),c.splice(c.indexOf(p),1)}else l=!0,this.onError(Error('Cannot create new index "'+p+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."));else l=!0,this.onError(Error("Cannot create index: No index name given."))},this),c.length&&(l=!0,this.onError(Error('Cannot delete index(es) "'+c.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),l||this.onStoreReady()}else this.onError(Error("Object store couldn't be created."))}).bind(this),i.onupgradeneeded=(function(s){this.db=s.target.result,this.db.objectStoreNames.contains(this.storeName)?this.store=s.target.transaction.objectStore(this.storeName):(s={autoIncrement:this.autoIncrement},this.keyPath!==null&&(s.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,s));var c=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(v){var p=v.name;if(p||(l=!0,this.onError(Error("Cannot create index: No index name given."))),this.normalizeIndexData(v),this.hasIndex(p)){var g=this.store.index(p);this.indexComplies(g,v)||(this.store.deleteIndex(p),this.store.createIndex(p,v.keyPath,{unique:v.unique,multiEntry:v.multiEntry})),c.splice(c.indexOf(p),1)}else this.store.createIndex(p,v.keyPath,{unique:v.unique,multiEntry:v.multiEntry})},this),c.length&&c.forEach(function(v){this.store.deleteIndex(v)},this)}).bind(this)},deleteDatabase:function(i,l){if(this.idb.deleteDatabase){this.db.close();var s=this.idb.deleteDatabase(this.dbName);s.onsuccess=i,s.onerror=l}else l(Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(i,l,s,c){this.keyPath!==null&&(c=s,s=l,l=i),c||(c=r),s||(s=u);var v=!1,p=null,g=this.db.transaction([this.storeName],this.consts.READ_WRITE);return g.oncomplete=function(){(v?s:c)(p)},g.onabort=c,g.onerror=c,this.keyPath!==null?(this._addIdPropertyIfNeeded(l),i=g.objectStore(this.storeName).put((()=>{function m(y){return y&&(y instanceof FileSystemFileHandle||y instanceof FileSystemDirectoryHandle)}function x(y){if(m(y)||typeof y!="object"||y===null)return y;if(Array.isArray(y))return y.map(k=>x(k));const S={};for(const k in y)y.hasOwnProperty(k)&&(S[k]=x(y[k]));return S}return x(l)})())):i=g.objectStore(this.storeName).put(l,i),i.onsuccess=function(m){v=!0,p=m.target.result},i.onerror=c,g},get:function(i,l,s){s||(s=r),l||(l=u);var c=!1,v=null,p=this.db.transaction([this.storeName],this.consts.READ_ONLY);return p.oncomplete=function(){(c?l:s)(v)},p.onabort=s,p.onerror=s,i=p.objectStore(this.storeName).get(i),i.onsuccess=function(g){c=!0,v=g.target.result},i.onerror=s,p},remove:function(i,l,s){s||(s=r),l||(l=u);var c=!1,v=null,p=this.db.transaction([this.storeName],this.consts.READ_WRITE);return p.oncomplete=function(){(c?l:s)(v)},p.onabort=s,p.onerror=s,i=p.objectStore(this.storeName).delete(i),i.onsuccess=function(g){c=!0,v=g.target.result},i.onerror=s,p},batch:function(i,l,s){if(s||(s=r),l||(l=u),Object.prototype.toString.call(i)!="[object Array]")s(Error("dataArray argument must be of type Array."));else if(i.length===0)return l(!0);var c=i.length,v=!1,p=!1,g=this.db.transaction([this.storeName],this.consts.READ_WRITE);g.oncomplete=function(){(p?l:s)(p)},g.onabort=s,g.onerror=s;var m=function(){c--,c!==0||v||(p=v=!0)};return i.forEach(function(x){var y=x.type,S=x.key,k=x.value;x=function(M){g.abort(),v||(v=!0,s(M,y,S))},y=="remove"?(k=g.objectStore(this.storeName).delete(S),k.onsuccess=m,k.onerror=x):y=="put"&&(this.keyPath!==null?(this._addIdPropertyIfNeeded(k),k=g.objectStore(this.storeName).put(k)):k=g.objectStore(this.storeName).put(k,S),k.onsuccess=m,k.onerror=x)},this),g},putBatch:function(i,l,s){return i=i.map(function(c){return{type:"put",value:c}}),this.batch(i,l,s)},upsertBatch:function(i,l,s,c){typeof l=="function"&&(c=s=l,l={}),c||(c=r),s||(s=u),l||(l={}),Object.prototype.toString.call(i)!="[object Array]"&&c(Error("dataArray argument must be of type Array."));var v=l.keyField||this.keyPath,p=i.length,g=!1,m=!1,x=0,y=this.db.transaction([this.storeName],this.consts.READ_WRITE);y.oncomplete=function(){m?s(i):c(!1)},y.onabort=c,y.onerror=c;var S=function(k){i[x++][v]=k.target.result,p--,p!==0||g||(m=g=!0)};return i.forEach(function(k){var M=k.key;this.keyPath!==null?(this._addIdPropertyIfNeeded(k),k=y.objectStore(this.storeName).put(k)):k=y.objectStore(this.storeName).put(k,M),k.onsuccess=S,k.onerror=function(H){y.abort(),g||(g=!0,c(H))}},this),y},removeBatch:function(i,l,s){return i=i.map(function(c){return{type:"remove",key:c}}),this.batch(i,l,s)},getBatch:function(i,l,s,c){if(s||(s=r),l||(l=u),c||(c="sparse"),Object.prototype.toString.call(i)!="[object Array]")s(Error("keyArray argument must be of type Array."));else if(i.length===0)return l([]);var v=[],p=i.length,g=!1,m=null,x=this.db.transaction([this.storeName],this.consts.READ_ONLY);x.oncomplete=function(){(g?l:s)(m)},x.onabort=s,x.onerror=s;var y=function(S){S.target.result||c=="dense"?v.push(S.target.result):c=="sparse"&&v.length++,p--,p===0&&(g=!0,m=v)};return i.forEach(function(S){S=x.objectStore(this.storeName).get(S),S.onsuccess=y,S.onerror=function(k){m=k,s(k),x.abort()}},this),x},getAll:function(i,l){l||(l=r),i||(i=u);var s=this.db.transaction([this.storeName],this.consts.READ_ONLY),c=s.objectStore(this.storeName);return c.getAll?this._getAllNative(s,c,i,l):this._getAllCursor(s,c,i,l),s},_getAllNative:function(i,l,s,c){var v=!1,p=null;i.oncomplete=function(){(v?s:c)(p)},i.onabort=c,i.onerror=c,i=l.getAll(),i.onsuccess=function(g){v=!0,p=g.target.result},i.onerror=c},_getAllCursor:function(i,l,s,c){var v=[],p=!1,g=null;i.oncomplete=function(){(p?s:c)(g)},i.onabort=c,i.onerror=c,i=l.openCursor(),i.onsuccess=function(m){(m=m.target.result)?(v.push(m.value),m.continue()):(p=!0,g=v)},i.onError=c},clear:function(i,l){l||(l=r),i||(i=u);var s=!1,c=null,v=this.db.transaction([this.storeName],this.consts.READ_WRITE);v.oncomplete=function(){(s?i:l)(c)},v.onabort=l,v.onerror=l;var p=v.objectStore(this.storeName).clear();return p.onsuccess=function(g){s=!0,c=g.target.result},p.onerror=l,v},_addIdPropertyIfNeeded:function(i){typeof i[this.keyPath]>"u"&&(i[this.keyPath]=this._insertIdCount+++Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(i){return this.store.indexNames.contains(i)},normalizeIndexData:function(i){i.keyPath=i.keyPath||i.name,i.unique=!!i.unique,i.multiEntry=!!i.multiEntry},indexComplies:function(i,l){return["keyPath","unique","multiEntry"].every(function(s){if(s=="multiEntry"&&i[s]===void 0&&l[s]===!1)return!0;if(s=="keyPath"&&Object.prototype.toString.call(l[s])=="[object Array]"){s=l.keyPath;var c=i.keyPath;if(typeof c=="string")return s.toString()==c;if(typeof c.contains!="function"&&typeof c.indexOf!="function"||c.length!==s.length)return!1;for(var v=0,p=s.length;v<p;v++)if(!(c.contains&&c.contains(s[v])||c.indexOf(s[v]!==-1)))return!1;return!0}return l[s]==i[s]})},iterate:function(i,l){l=o({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:r,limit:1/0,offset:0,allowItemRejection:!1},l||{});var s=l.order.toLowerCase()=="desc"?"PREV":"NEXT";l.filterDuplicates&&(s+="_NO_DUPLICATE");var c=!1,v=this.db.transaction([this.storeName],this.consts[l.writeAccess?"READ_WRITE":"READ_ONLY"]),p=v.objectStore(this.storeName);l.index&&(p=p.index(l.index));var g=0;return v.oncomplete=function(){c?l.onEnd?l.onEnd():i(null):l.onError(null)},v.onabort=l.onError,v.onerror=l.onError,s=p.openCursor(l.keyRange,this.consts[s]),s.onerror=l.onError,s.onsuccess=function(m){if(m=m.target.result)if(l.offset)m.advance(l.offset),l.offset=0;else{var x=i(m.value,m,v);l.allowItemRejection&&x===!1||g++,l.autoContinue&&(g+l.offset<l.limit?m.continue():c=!0)}else c=!0},v},query:function(i,l){var s=[],c=0;return l=l||{},l.autoContinue=!0,l.writeAccess=!1,l.allowItemRejection=!!l.filter,l.onEnd=function(){i(s,c)},this.iterate(function(v){c++;var p=l.filter?l.filter(v):!0;return p!==!1&&s.push(v),p},l)},count:function(i,l){l=o({index:null,keyRange:null},l||{});var s=l.onError||r,c=!1,v=null,p=this.db.transaction([this.storeName],this.consts.READ_ONLY);p.oncomplete=function(){(c?i:s)(v)},p.onabort=s,p.onerror=s;var g=p.objectStore(this.storeName);return l.index&&(g=g.index(l.index)),g=g.count(l.keyRange),g.onsuccess=function(m){c=!0,v=m.target.result},g.onError=s,p},makeKeyRange:function(i){var l=typeof i.lower<"u",s=typeof i.upper<"u",c=typeof i.only<"u";switch(!0){case c:i=this.keyRange.only(i.only);break;case(l&&s):i=this.keyRange.bound(i.lower,i.upper,i.excludeLower,i.excludeUpper);break;case l:i=this.keyRange.lowerBound(i.lower,i.excludeLower);break;case s:i=this.keyRange.upperBound(i.upper,i.excludeUpper);break;default:throw Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return i}},w={};return d.prototype=h,d.version=h.version,d},this),n=new IDBStore(e)})},"indexeddb",!0),allfuncs.new("keepsame",function(e){var t=[],n=new Proxy(e,{get(o,r){return r=="val"?o:r=="all"?t:r=="func"?function(u){return t.push(u(e)),n}:function(...u){try{t.push(e[r](e,...u))}catch{t.push(e[r])}return n}}});return n},"function",!0),allfuncs.new("strictfunction",strictfunction,"function/typescript",!0),allfuncs.new("readfileslow",function(e,t="Text",n=r=>r,o=r=>r){var r=e.size,u=64*1024*50,f=0,d=null,h=[],w,i=function(s,c){if(s.target.error==null)h.push([c,s.target.result]),n(a(h.length).rerange(0,w,0,100).val),h.length===w&&o(h.sort(v=>v[0]).map(v=>v[1]));else return error("Read error: "+s.target.error)};d=function(s,c,v,p){var g=new FileReader,m=v.slice(s,c+s);const x=p+1;g.onload=function(y){i(y,x-1)},g["readAs"+t](m)};let l=0;for(;f<r;)l++,d(f,u,e,l),f+=u;w=l},"file"),allfuncs.new("cbtoasync",function(e,...t){return new Promise(function(n){e(...t,n)})},"function"),allfuncs.new("asynctocb",function(e,...t){var n=t.pop();return e(...t).then(n)},"function"),allfuncs.new("randstr",function({lower:e=!0,upper:t=!1,number:n=!1,symbol:o=!1,length:r=20}={lower:!0,upper:!1,number:!1,symbol:!1,length:20}){var u="";return a(()=>{u+=a(`${e?"asdfghjklzxcvbnmqwertyuiop":""}${t?"ASDFGHJKLQWERTYUIOPZXCVBNM":""}${n?"0123456789":""}${o?",./;'[]-=\\`~!@#$%^&*()_+|{}:\"<>?":""}`.split("")).randfrom().val}).repeat(r),u},"random/string"),allfuncs.new("toplaces",function(e,t,n=0,o=Math.round){if(e=String(e).split("."),e.length==1&&e.push(""),t!==void 0)for(e[0]=e[0].substring(e[0].length-t,e[0].length);e[0].length<t;)e[0]="0"+e[0];var r=e[1].substring(n,n+1)??0;for(e[1]=e[1].substring(0,n);e[1].length<n;)e[1]+="0";return n>0?(r=o(e[1].at(-1)+"."+r),e[1]=e[1].split(""),e[1].pop(),e[1].push(r),e[1]=e[1].join(""),e=e.join(".")):e=e[0],e},"number/format",!0),allfuncs.new("forcenumlength",function(e,t){var n=-1;if(a(t).gettype("object").val&&(t=t[[...e.matchAll(/\d+(?:\.\d+)?/g)].length]),!t){log(e);debugger}return e.replaceAll(/\d+(?:\.\d+)?/g,function(o){n++;try{return a(t[n]).gettype("array").val?a(Number(o)).toplaces(t[n][0],t[n][1]).val:a(Number(o)).toplaces(t[n],0).val}catch{log(e,t,n);debugger}})},"number/format",!0),function(){var e=Date.now();allfuncs.new("tick",function(){var t=Date.now()-e;return e=Date.now(),t},"time")}(),allfuncs.new("expandederror",expandederror,"error",!0),allfuncs.new("fetch",async function(e,t="text",...n){return await(await fetch(e,...n))[t]()},"url/web"),allfuncs.new("copy",function(e){return navigator.clipboard.writeText(e),""},"clipboard"),Object.keys(console).forEach(e=>allfuncs.new(e,(...t)=>console[e](...t),"console/debug")),allfuncs.new("replaceall",function(e,t,n){return e.replaceAll(a(String(a(t).toregex().val)+"g").toregex().val,n)},""),allfuncs.new("setrange",function(e,t,n){return e<t?t:e>n?n:e},"number"),allfuncs.new("isstrict",function(e){var t;return((t=e==null?void 0:e.strictargs)==null?void 0:t[0])===isstrict},"typescript"),allfuncs.new("runonalltext",function(e,t=["STYLE","SCRIPT","NOSCRIPT"]){a("*").qsa().foreach(o),n(document.documentElement);function n(r){new MutationObserver(u=>{location.href.includes("scratch.mit.edu/projects")||[...u].forEach(f=>o(f.target))}).observe(r,{childList:!0,subtree:!0,attributes:!0,characterData:!1})}function o(r){var w,i;if(r.shadowRoot)return a("*").qsa(r.shadowRoot).foreach(o),n(r.shadowRoot),o(r.shadowRoot);if(!(t.map(l=>l.toLowerCase()).includes((i=(w=r==null?void 0:r.tagName)==null?void 0:w.toLowerCase)==null?void 0:i.call(w))||r!=null&&r.matches&&t.find(l=>{var s;return(s=r==null?void 0:r.matches)==null?void 0:s.call(r,l)}))){var u=r==null?void 0:r.childNodes;if(u)for(var f=0,d=u.length;f<d;f++){var h=u[f];h.nodeType==h.TEXT_NODE?e(h):o(h)}}}},"text/elem"),allfuncs.new("runonallelems",function e(t,n="*",o=[]){new MutationObserver(u=>{[...u].forEach(f=>r(f.target))}).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),a(n).qsa().foreach(r);function r(u){if(u.nodeType===1){if(u.shadowRoot){r(u.shadowRoot);const d=u.shadowRoot.querySelectorAll(n);for(const h of d)o.includes(h.tagName.toLowerCase())||t(h)}const f=u.querySelectorAll(n);for(const d of f)o.includes(d.tagName.toLowerCase())||t(d)}}},"elem"),allfuncs.new("say",async function(e,t=100,n=3){debugger;speechSynthesis.cancel(),speechSynthesis.speak(a(new SpeechSynthesisUtterance).set.text(e+" ").set.volume(a(t).rerange(0,100,0,1).val).set.rate(3).set.lang("en").val),await a(o=>speechSynthesis.speaking).waituntil(),await a(o=>!speechSynthesis.speaking).waituntil()}),savelib("allfuncs",a);function extras(){(()=>{if(!window.showDirectoryPicker||!window.showOpenFilePicker||!window.showSaveFilePicker)return;const e={showDirectoryPicker:showDirectoryPicker.bind(window),showOpenFilePicker:showOpenFilePicker.bind(window),showSaveFilePicker:showSaveFilePicker.bind(window)};showDirectoryPicker=a(function(t=!1){return t===!0?t={mode:"readwrite"}:t===!1&&(t={mode:"read"}),e.showDirectoryPicker(t)}).strictfunction("showDirectoryPicker").val,showOpenFilePicker=a(async function(t={},n,o,r,u,f=!1){if(t.types&&!r&&(r=t.types,delete t.types),t.exts&&!u&&(u=t.exts,delete t.exts),f&&(t.excludeAcceptAllOption=!0),t.name&&(t.suggestedName=t.name),o!==void 0&&(t.multiple=o,delete t.name),u&&(t.types={accept:{"*/*":u}}),r&&(t.type||(t.type={accept:{}}),r.forEach(h=>t.type.accept[h]=["*"])),t.multiple)return await e.showOpenFilePicker(t);var d=await e.showOpenFilePicker(t);if(d=d[0]??d,(t.mode=="readwrite"||n)&&await d.requestPermission({mode:"readwrite"})!=="granted")throw new Error("user didn't grant write permission");return d}).strictfunction("showOpenFilePicker").val,showSaveFilePicker=a(function(t={},n=!1,o,r,u=!1){return typeof t=="string"&&(t={suggestedName:t}),t.types&&!o&&(o=t.types,delete t.types),t.exts&&!r&&(r=t.exts,delete t.exts),u&&(t.excludeAcceptAllOption=!0),t.name&&(t.suggestedName=t.name),n!==void 0&&(t.multiple=n,delete t.name),r&&(t.types={accept:{"*/*":r}}),o&&(t.type||(t.type={accept:{}}),o.forEach(f=>t.type.accept[f]=["*"])),e.showSaveFilePicker(t)}).strictfunction("showSaveFilePicker").val})()}extras(),await loadlib("libloader").waitforlib("scratch"),(()=>{const e=loadlib("scratch").vm;allfuncs.new("scratch_gettarget",function(t){if(t)var n=e.runtime.getSpriteTargetByName(t);else var n=e.runtime.getTargetForStage();return n.getvar=n.lookupVariableByNameAndType,n},"scratch",!0),allfuncs.new("scratch_sendbroadcast",function(t){return e.runtime.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:t}),t},"scratch",!0),allfuncs.new("scratch_canvas",function(){var t,n,o;return((o=(n=(t=window==null?void 0:window.vm)==null?void 0:t.runtime)==null?void 0:n.renderer)==null?void 0:o.canvas)||a("#app > div > div.gui_body-wrapper_-N0sA.box_box_2jjDp > div > div.gui_stage-and-target-wrapper_69KBf.box_box_2jjDp > div.stage-wrapper_stage-wrapper_2bejr.box_box_2jjDp > div.stage-wrapper_stage-canvas-wrapper_3ewmd.box_box_2jjDp > div > div.stage_stage_1fD7k.box_box_2jjDp > div:nth-child(1) > canvas").qs().val||a("#view > div > div.inner > div:nth-child(2) > div.guiPlayer > div.stage-wrapper_stage-wrapper_2bejr.box_box_2jjDp > div.stage-wrapper_stage-canvas-wrapper_3ewmd.box_box_2jjDp > div > div.stage_stage_1fD7k.box_box_2jjDp > div:nth-child(1) > canvas").qs().val||a("#app > div > div > div > div.gui_body-wrapper_-N0sA.box_box_2jjDp > div > div.gui_stage-and-target-wrapper_69KBf.box_box_2jjDp > div.stage-wrapper_stage-wrapper_2bejr.box_box_2jjDp > div.stage-wrapper_stage-canvas-wrapper_3ewmd.box_box_2jjDp > div > div.stage_stage_1fD7k.box_box_2jjDp > div:nth-child(1) > canvas").qs().val},"scratch",!1),allfuncs.new("scratch_press",function(t){t==" "&&(t="space"),/^[a-z]$/.test(t)&&(t=t.toUpperCase());var n=e.runtime.ioDevices.keyboard._keysPressed.indexOf(t);return n!==-1&&e.runtime.ioDevices.keyboard._keysPressed.splice(n,1),e.runtime.ioDevices.keyboard._keysPressed.push(t),e.runtime.startHats("event_whenkeypressed",{KEY_OPTION:t}),e.runtime.startHats("event_whenkeypressed",{KEY_OPTION:"any"}),t},"scratch"),allfuncs.new("scratch_unpress",function(t){t==" "&&(t="space"),/^[a-z]$/.test(t)&&(t=t.toUpperCase());var n=e.runtime.ioDevices.keyboard._keysPressed.indexOf(t);n!==-1&&e.runtime.ioDevices.keyboard._keysPressed.splice(n,1)},"scratch"),allfuncs.new("scratch_getallkeys",function(){var t=e.runtime,n={bools:t.targets.map(o=>({name:o.sprite.name,blocks:Object.values(o.blocks._blocks).filter(r=>r.opcode==="sensing_keypressed").map(r=>r.inputs.KEY_OPTION.block),otherblocks:o.blocks._blocks})).filter(o=>o.blocks.length).map(o=>({name:o.name,value:[...new Set(o.blocks.map(r=>o.otherblocks[r]).map(r=>{var u,f,d,h;return((f=(u=r.fields)==null?void 0:u.KEY_OPTION)==null?void 0:f.value)||((h=(d=r.fields)==null?void 0:d.VALUE)==null?void 0:h.value)||error(r)}))]})),hats:t.targets.map(o=>({name:o.name,blocks:Object.values(o.blocks).filter(r=>r.opcode==="event_whenkeypressed").map(r=>r.fields.KEY_OPTION.value)})).filter(o=>o.blocks.length)};return n.all=[...n.hats.map(o=>o.blocks).flat(),...n.bools.map(o=>o.value).flat()],n.all=[...new Set(n.all)],n},"scratch",!1)})()})()});export default X();
