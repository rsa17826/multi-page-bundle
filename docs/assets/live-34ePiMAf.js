(function(){var C={Etag:1,"Last-Modified":1,"Content-Length":1,"Content-Type":1},m={},b={},p={},u={},E=1e3,j=!1,d={html:1,css:1,js:1},r={heartbeat:function(){document.body&&(j||r.loadresources(),r.checkForChanges()),setTimeout(r.heartbeat,E)},loadresources:function(){function o(x){var v=document.location,y=new RegExp("^\\.|^/(?!/)|^[\\w]((?!://).)*$|"+v.protocol+"//"+v.host);return x.match(y)}for(var i=document.getElementsByTagName("script"),t=document.getElementsByTagName("link"),a=[],e=0;e<i.length;e++){var s=i[e],n=s.getAttribute("src");if(n&&o(n)&&a.push(n),n&&n.match(/\blive.js#/)){for(var c in d)d[c]=n.match("[#,|]"+c)!=null;n.match("notify")&&alert("Live.js is loaded.")}}d.js||(a=[]),d.html&&a.push(document.location.href);for(var e=0;e<t.length&&d.css;e++){var l=t[e],w=l.getAttribute("rel"),h=l.getAttribute("href",2);h&&w&&w.match(new RegExp("stylesheet","i"))&&o(h)&&(a.push(h),p[h]=l)}for(var e=0;e<a.length;e++){var L=a[e];r.getHead(L,function(v,y){m[v]=y})}var N=document.getElementsByTagName("head")[0],f=document.createElement("style"),g="transition: all .3s ease-out;";css=[".livejs-loading * { ",g," -webkit-",g,"-moz-",g,"-o-",g,"}"].join(""),f.setAttribute("type","text/css"),N.appendChild(f),f.styleSheet?f.styleSheet.cssText=css:f.appendChild(document.createTextNode(css)),j=!0},checkForChanges:function(){for(var o in m)b[o]||r.getHead(o,function(i,t){var a=m[i],e=!1;m[i]=t;for(var s in a){var n=a[s],c=t[s],l=t["Content-Type"];switch(s.toLowerCase()){case"etag":if(!c)break;default:e=n!=c;break}if(e){r.refreshResource(i,l);break}}})},refreshResource:function(o,i){switch(i.toLowerCase()){case"text/css":var t=p[o],a=document.body.parentNode,e=t.parentNode,s=t.nextSibling,n=document.createElement("link");a.className=a.className.replace(/\s*livejs\-loading/gi,"")+" livejs-loading",n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",o+"?now="+new Date*1),s?e.insertBefore(n,s):e.appendChild(n),p[o]=n,u[o]=t,r.removeoldLinkElements();break;case"text/html":if(o!=document.location.href)return;case"text/javascript":case"application/javascript":case"application/x-javascript":document.location.reload()}},removeoldLinkElements:function(){var o=0;for(var i in u){try{var t=p[i],a=u[i],e=document.body.parentNode,s=t.sheet||t.styleSheet,n=s.rules||s.cssRules;n.length>=0&&(a.parentNode.removeChild(a),delete u[i],setTimeout(function(){e.className=e.className.replace(/\s*livejs\-loading/gi,"")},100))}catch{o++}o&&setTimeout(r.removeoldLinkElements,50)}},getHead:function(o,i){b[o]=!0;var t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XmlHttp");t.open("HEAD",o,!0),t.onreadystatechange=function(){if(delete b[o],t.readyState==4&&t.status!=304){t.getAllResponseHeaders();var a={};for(var e in C){var s=t.getResponseHeader(e);e.toLowerCase()=="etag"&&s&&(s=s.replace(/^W\//,"")),e.toLowerCase()=="content-type"&&s&&(s=s.replace(/^(.*?);.*?$/i,"$1")),a[e]=s}i(o,a)}},t.send()}};document.location.protocol!="file:"?(window.liveJsLoaded||requestAnimationFrame(r.heartbeat),window.liveJsLoaded=!0):window.console&&console.log("Live.js doesn't support the file protocol. It needs http.")})();
